
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Những khác biệt giữa các loại Provider trong AngularJS</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=2417c80ea1">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/monokai_sublime.min.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic,500,500italic,700,700italic&amp;subset=latin,latin-ext,vietnamese">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/jqcloud/1.0.4/jqcloud.css">

    <link rel="canonical" href="http://localhost:2368/angularjs-factory-service-provider/">
    <meta name="referrer" content="origin">
    
    <meta property="og:site_name" content="viphat's notes">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Những khác biệt giữa các loại Provider trong AngularJS">
    <meta property="og:description" content="Khi quay lại với nghiệp Web Developer sau hơn 4 năm ra trường và gắn bó với công việc của một Data Processing trong lĩnh vực nghiên cứu thị trường. Số phận đưa đẩy thế nào mà mình phải học...">
    <meta property="og:url" content="http://localhost:2368/angularjs-factory-service-provider/">
    <meta property="article:published_time" content="2015-06-29T00:00:00.000Z">
    <meta property="article:modified_time" content="2015-11-16T00:57:37.411Z">
    <meta property="article:tag" content="AngularJS">
    <meta property="article:tag" content="Javascript">
    <meta property="article:tag" content="Front End">
    <meta property="article:tag" content="CoffeeScript">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Những khác biệt giữa các loại Provider trong AngularJS">
    <meta name="twitter:description" content="Khi quay lại với nghiệp Web Developer sau hơn 4 năm ra trường và gắn bó với công việc của một Data Processing trong lĩnh vực nghiên cứu thị trường. Số phận đưa đẩy thế nào mà mình phải học...">
    <meta name="twitter:url" content="http://localhost:2368/angularjs-factory-service-provider/">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "viphat's notes",
    "author": {
        "@type": "Person",
        "name": "Duong Vi Phat",
        "image": "http://localhost:2368/content/images/2015/09/avatar-ninja.png",
        "url": "http://localhost:2368/author/viphat",
        "sameAs": null,
        "description": null
    },
    "headline": "Những khác biệt giữa các loại Provider trong AngularJS",
    "url": "http://localhost:2368/angularjs-factory-service-provider/",
    "datePublished": "2015-06-29T00:00:00.000Z",
    "dateModified": "2015-11-16T00:57:37.411Z",
    "keywords": "AngularJS, Javascript, Front End, CoffeeScript",
    "description": "Khi quay lại với nghiệp Web Developer sau hơn 4 năm ra trường và gắn bó với công việc của một Data Processing trong lĩnh vực nghiên cứu thị trường. Số phận đưa đẩy thế nào mà mình phải học..."
}
    </script>

    <meta name="generator" content="Ghost 0.7">
    <link rel="alternate" type="application/rss+xml" title="viphat's notes" href="http://localhost:2368/rss/">

</head>
<body class="post-template tag-angularjs tag-javascript tag-front-end tag-coffeescript">

    

<main class="content" role="main">
    <div id="toc"></div>
    <nav class="main-nav">
          <i class="fa fa-bars js-main-menu-open element-light right" style="font-size:30px; margin-left:5px;"></i>
    </nav>
    <article class="post tag-angularjs tag-javascript tag-front-end tag-coffeescript">



        <header class="post-header">
            <a id="blog-logo" href="http://localhost:2368">
                    <img src="../content/images/2015/06/988902_10153164942799169_3258802522813421684_n.jpg" alt="notes.viphat.work">
            </a>
        </header>


        <span class="post-meta"><time datetime="2015-06-29">29 Jun 2015</time> on <a href="../tag/angularjs/">AngularJS</a> | <a href="../tag/javascript/">Javascript</a> | <a href="../tag/front-end/">Front End</a> | <a href="../tag/coffeescript/">CoffeeScript</a></span>

        <h1 class="post-title">Những khác biệt giữa các loại Provider trong AngularJS</h1>

        <section class="post-content">
            <p>Khi quay lại với nghiệp Web Developer sau hơn 4 năm ra trường và gắn bó với công việc của một Data Processing trong lĩnh vực nghiên cứu thị trường. Số phận đưa đẩy thế nào mà mình phải học và làm việc với framework bên Front-End là <strong>AngularJS</strong>. Tuy vậy, sau thời gian dài làm việc, mình vẫn chưa hệ thống hóa kiến thức AngularJS của mình một cách bài bản lắm. Ngẫm lại, mình chỉ sử dụng nhiều đến <code>module</code>, <code>$scope</code>, <code>controller</code>, <code>directive</code>, một ít <code>service</code> và các thể loại, dòng họ nhà <code>ng-xxx</code> (ng-app, ng-if, ng-show, ng-init, ng-click, ng-class...) trong AngularJS thôi chứ ít đụng đến các chức năng cao cấp hơn, cũng không tuân theo mô hình MVVM và tổ chức cấu trúc File một cách hợp lý và cũng không viết ứng dụng dạng Single Page. Đó thật là thiếu sót của mình khi không thể khai thác hết sức mạnh của AngularJS. Mình ấp ủ thực hiện loạt bài này đã lâu và đây là lúc bắt tay vào hành động. (Và hy vọng hoàn thành nó trước khi nó kịp lỗi thời vì AngularJS 2.0 sắp xuất hiện.)</p>

<p>Nói thật, Mình quen thuộc <strong>AngularJS</strong> còn hơn cả jQuery, quen viết bằng <strong>CoffeeScript</strong> còn hơn cả viết bằng JavaScript. Do đó, hầu hết các ví dụ trong bài đều sử dụng <strong>CoffeeScript</strong>.</p>

<p>Bài hôm nay giúp liệt kê các loại Provider mà AngularJS cung cấp cho chúng ta: <mark>constant, value, service, factory, decorator, provider</mark>. Hiểu rõ sự khác biệt giữa chúng, bạn sẽ biết tùy nghi sử dụng chúng sao cho phù hợp với mục đích của mình. (Mình nhớ một câu nói, nếu bạn phải sử dụng đến $rootScope để chia sẻ Scope giữa các Controller, hay tệ hơn là không biết chia sẻ dữ liệu giữa các Controller với nhau. Vậy là bạn đang đi sai cách rồi đấy)</p>

<p>Các dịch vụ này đều được cung cấp bởi $provide và bạn có thể dễ dàng inject chúng để sử dụng vào các Controller, Directive. (<strong>Dependency Injection</strong> là một trong những điểm mạnh của AngularJS - Nếu chưa biết DI là gì, bạn có thể tự tìm hiểu thêm, Mình cũng có dự định sẽ viết một bài về vấn đề này trong Loạt bài tìm hiểu về AngularJS.)</p>

<h5 id="constanthngs">Constant (Hằng số)</h5>

<p>Hằng số có thể được inject vào bất cứ đâu. Một Hằng số không thể thay đổi giá trị sau khi nó đã được khởi tạo</p>

<p>Khởi tạo hằng số</p>

<pre><code>var app = angular.module('app', []);  
app.constant('movieTitle', 'The Matrix');  
app.controller('ctrl', function (movieTitle) {  
  expect(movieTitle).toEqual('The Matrix');
});
</code></pre>

<p><strong>Một cách khởi tạo khác</strong> (thông qua <code>$provide</code>)</p>

<pre><code>app.config(function ($provide) {  
  $provide.constant('movieTitle', 'The Matrix');
});
</code></pre>

<h5 id="value">Value</h5>

<p>Khác với Hằng số, Value (Giá trị) có thể bị thay đổi sau khi đã khởi tạo. Value có thể là một chuỗi, một số hay một hàm</p>

<p><strong>Khởi tạo Value</strong></p>

<pre><code>var app = angular.module('app', []);  
app.value('movieTitle', 'The Matrix');  
app.controller('ctrl', function (movieTitle) {  
  expect(movieTitle).toEqual('The Matrix');
});
</code></pre>

<p><strong>Một cách khởi tạo khác</strong> (Thông qua <code>$provide</code>)</p>

<pre><code>app.config(function ($provide) {  
  $provide.value('movieTitle', 'The Matrix')
});
</code></pre>

<h5 id="decorator">Decorator</h5>

<p>Decorator là một mẫu thiết kế được dùng để thay đổi giá trị hoặc bao đóng các Provider khác. Trừ trường hợp ngoại lệ là Decorator không can thiệp được Constant.</p>

<pre><code>var app = angular.module('app', []);  
app.value('movieTitle', 'The Matrix');  
app.config(function ($provide) {  
  $provide.decorator('movieTitle', function ($delegate) {
    return $delegate + ' - starring Keanu Reeves';
  });
});
app.controller('myController', function (movieTitle) {  
  expect(movieTitle).toEqual('The Matrix - starring Keanu Reeves');
});
</code></pre>

<h5 id="service">Service</h5>

<p>Service là một Injectable Constructor. Khi inject vào một controller nghĩa là bạn đã inject một instance của các function có trong Service đó vào controller.</p>

<p>Service là cách tốt nhất để giao tiếp và chia sẻ dữ liệu giữa các Controller với nhau.</p>

<p><strong>Khởi tạo Service</strong> </p>

<pre><code>var app = angular.module('app' ,[]);

app.service('movie', function () {  
  this.title = 'The Matrix';
});

app.controller('ctrl', function (movie) {  
  expect(movie.title).toEqual('The Matrix');
});
</code></pre>

<p><strong>Cách khác để khởi tạo Service</strong></p>

<pre><code>app.config(function ($provide) {  
  $provide.service('movie', function () {
    this.title = 'The Matrix';
  });
});
</code></pre>

<h5 id="factory">Factory</h5>

<p>Factory là một injectable function. Thoạt nhìn thì nó khá giống Service nhưng điểm khác nhau chính giữa chúng là Factory Inject một plain function còn Service inject contructor. Ứng dụng của Factory: Could be useful for returning a 'class' function that can then be new'ed to create instances.</p>

<p>Có vẻ khó hiểu nhỉ, vô tư đi, không sao cả. Chúng ta sẽ xem qua cách khởi tạo một Factory và sau đó bằng nhiều ví dụ, chúng ta sẽ thấy được sự khác biệt giữa Factory và Service cũng như Factory và Provider.</p>

<p><strong>Khởi tạo Factory</strong></p>

<pre><code>var app = angular.module('app', []);

app.factory('movie', function () {  
  return {
    title: 'The Matrix';
  }
});

app.controller('ctrl', function (movie) {  
  expect(movie.title).toEqual('The Matrix');
});
</code></pre>

<p><strong>Cách khác để khởi tạo Factory</strong></p>

<pre><code>app.config(function ($provide) {  
  $provide.factory('movie', function () {
    return {
      title: 'The Matrix';
    }
  });
});
</code></pre>

<h5 id="provider">Provider</h5>

<p>Provider là trường hợp phức tạp nhất (và cũng mạnh mẽ nhất) trong số các Provider, Nó giống Factory nhưng cho phép bạn cấu hình bằng các configuration option (Nói nôm na Provider là một Configurable Factory).</p>

<p><strong>Khởi tạo Provider</strong> </p>

<pre><code>var app = angular.module('app', []);

app.provider('movie', function () {  
  var version;
  return {
    setVersion: function (value) {
      version = value;
    },
    $get: function () {
      return {
          title: 'The Matrix' + ' ' + version
      }
    }
  }
});

app.config(function (movieProvider) {  
  movieProvider.setVersion('Reloaded');
});

app.controller('ctrl', function (movie) {  
  expect(movie.title).toEqual('The Matrix Reloaded');
});
</code></pre>

<h5 id="servicevsfactoryvsprovider">Service vs Factory vs Provider</h5>

<p>Một ví dụ hoàn chỉnh để thấy được sự khác nhau giữa Service - Factory - Provider:</p>

<pre><code>var app = angular.module( 'app', [] );  
var MyFunc = function() {  
  this.name = "default name";
  this.$get = function() {
    this.name = "new name"
    return "Hello from MyFunc.$get(). this.name = " + this.name;
  };
  return "Hello from MyFunc(). this.name = " + this.name;
};
</code></pre>

<p>Bây giờ ta có một hàm MyFunc đã khởi tạo trước, sẽ ra sao nếu Ta khởi tạo Service, Factory và Provider bằng hàm MyFunc này</p>

<pre><code>// returns the actual function
app.service( 'myService', MyFunc );  
// returns the function's return value
app.factory( 'myFactory', MyFunc );  
// returns the output of the function's $get function
app.provider( 'myProv', MyFunc );  
</code></pre>

<p><strong>Kết quả là</strong></p>

<pre><code>function MyCtrl( $scope, myService, myFactory, myProv ) {  
  $scope.serviceOutput = "myService = " + myService;
  $scope.factoryOutput = "myFactory = " + myFactory;
  $scope.providerOutput = "myProvider = " + myProv;
}
</code></pre>

<pre><code>myService = [object Object]  
myFactory = Hello from MyFunc(). this.name = default name  
myProvider = Hello from MyFunc.$get(). this.name = new name  
</code></pre>

<p><strong>Một ví dụ khác</strong></p>

<pre><code>provide.value('a', 123);  
function Controller(a) {  
  expect(a).toEqual(123);
}
</code></pre>

<p>Ở đây, chúng ta khởi tạo một value là a với giá trị 123, Nhưng nếu bạn muốn tính toán giá trị đó? Đây là lúc sử dụng <strong>Factory</strong></p>

<pre><code>provide.factory('b', function(a) {  
  return a*2;
});

function Controller(b) {  
  expect(b).toEqual(246);
}
</code></pre>

<p>Bây giờ, bạn có một Lớp Greeter</p>

<pre><code>function Greeter(a) {  
  this.greet = function() {
    return 'Hello ' + a;
  }
}
</code></pre>

<p>Và nếu sử dụng Factory cho Greeter này, bạn sẽ phải viết như sau:</p>

<pre><code>provide.factory('greeter', function(a) {  
  return new Greeter(a);
});
</code></pre>

<p>Sử dụng trong Controller</p>

<pre><code>function Controller(greeter) {  
  expect(greeter instanceof Greeter).toBe(true);
  expect(greeter.greet()).toEqual('Hello 123');
}
</code></pre>

<p>Rườm rà nhỉ, nếu sử dụng Service cho mục đích này, bạn sẽ thấy code sẽ clean hơn mà kết quả vẫn tương tự:</p>

<pre><code>provider.service('greeter', Greeter);  
</code></pre>

<p>Nhưng nếu muốn cấu hình lớp Greeter trước khi inject, bạn phải sử dụng Provider:</p>

<pre><code>provide.provider('greeter2', function() {  
  var salutation = 'Hello';
  this.setSalutation = function(s) {
    salutation = s;
  }

  function Greeter(a) {
    this.greet = function() {
      return salutation + ' ' + a;
    }
  }

  this.$get = function(a) {
    return new Greeter(a);
  };
});
</code></pre>

<p>Và có thể cấu hình chúng (thiết lập lại salutation) như sau:</p>

<pre><code>angular.module('abc', []).config(function(greeter2Provider) {  
  greeter2Provider.setSalutation('Halo');
});

function Controller(greeter2) {  
  expect(greeter2.greet()).toEqual('Halo 123');
}
</code></pre>

<h4 id="tmtt">Tóm tắt</h4>

<ul>
<li>All the providers are instantiated only once. That means that they are all singletons.</li>
<li>All the providers except constant can be decorated.</li>
<li>A constant is a value that can be injected everywhere. The value of a constant can never be changed.</li>
<li>A value is just a simple injectable value.</li>
<li>A service is an injectable constructor.</li>
<li>A factory is an injectable function.</li>
<li>A decorator can modify or encapsulate other providers except a constant.</li>
<li>A provider is a configurable factory.</li>
</ul>
        </section>

        <footer class="post-footer">

                <section class="author">
                    <h3>Duong Vi Phat</h3>
                    <p></p>
                </section>

            <section class="share">
                <h3>Share this</h3>
                <a class="icon-twitter" href="http://twitter.com/share?text=Nh%E1%BB%AFng%20kh%C3%A1c%20bi%E1%BB%87t%20gi%E1%BB%AFa%20c%C3%A1c%20lo%E1%BA%A1i%20Provider%20trong%20AngularJS&amp;url=http://localhost:2368/angularjs-factory-service-provider/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/angularjs-factory-service-provider/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://localhost:2368/angularjs-factory-service-provider/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>


    </article>

</main>


    <footer class="site-footer">
        <!-- <a class="subscribe icon-feed" href="http://localhost:2368/rss/"><span class="tooltip">Subscribe!</span></a> -->
        <div class="inner">
             <section class="social_links">
                <a href="https://twitter.com/viphat" target="_blank">
                  <i class="fa fa-twitter-square fa-2x"></i>
                </a>
                <a href="https://www.facebook.com/viphat" target="_blank">
                  <i class="fa fa-facebook-square fa-2x"></i>
                </a>
                <a href="https://github.com/viphat" target="_blank">
                  <i class="fa fa-github-square fa-2x"></i>
                </a>
             </section>
             <section class="copyright">All content copyright <a href="../">viphat's notes</a> © 2014-2015 • All rights reserved.</section>
             <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://ghost.org">Ghost</a> in <a href="https://github.com/viphat/The-Shell">The Shell</a> theme.</section>
        </div>
    </footer>

        <div class="main-menu-ovrl main-menu-ovrl-hugeinc js-main-menu-ovrl">
    <i class="fa fa-times main-menu-ovrl-close js-main-menu-close" style="margin-left: 5px; font-size:30px;"></i>
    <nav>
        <ul>
                <li style="font-size: 42px; padding-bottom:10px;">
                    <a href="http://localhost:2368/">Home</a>
                </li>
                <li style="font-size: 42px; padding-bottom:10px;">
                    <a href="http://localhost:2368/tag-cloud/">Tag Cloud</a>
                </li>
                <li style="font-size: 42px; padding-bottom:10px;">
                    <a href="http://localhost:2368/blog-archive/">Blog Archive</a>
                </li>
        </ul>
    </nav>
</div>

    <!-- You can safely delete this line if your theme does not require jQuery -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-53685619-1', 'auto');
      ga('send', 'pageview');
    </script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
    <script type="text/javascript" src="../assets/js/jqcloud-1.0.4.js"></script>
    <script type="text/javascript" src="../assets/js/toc.min.js"></script>
    <script type="text/javascript" src="../assets/js/shell.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.3/handlebars.min.js"></script>
</body>
